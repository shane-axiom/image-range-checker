<html>
  <head>
    <link href='http://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
    <style>
      body {
        font-family: 'Montserrat', sans-serif;
      }
      #url {
        width: 100%;
      }
      img {
        border-style: solid;
        border-color: black;
        border-width: 1px;
      }
      figure {
        margin-top: 2em;
      }
    </style>
    <script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
    <script>
      $.urlParam = function(name){
        var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);
        if (!results) { return undefined; }
        return results[1] || undefined;
      }

      $(document).ready(function() {
        $("#url").keypress(function(e) {
          if(e.which == 13) {
            loadUrls();
          }       
        });

        loadUrls = function() {
          var url = $("#url").val();
          var urls = buildUrls(url.split(/[\[\]]/));
          var $results = $("#results");
          $results.empty();
          for (var url of urls) {
            var $figure = $("<figure>");
            $figure.append($("<img>").prop("src", url));
            $figure.append($("<figcaption>").text(url));
            var $href = $("<a>").prop("href", url).prop("target", "_blank");
            $href.append($figure);
            $results.append($href);
          }
        };
        
        buildUrls = function(split) {
          var urls = [];
          if (split.length == 0) return [""];
          var cur = split.shift();
          if (/^(\d+)-(\d+)$/.test(cur)) {
            var rangeSplit = cur.split(/-/);
            for (var i = rangeSplit[0]; i <= rangeSplit[1]; i++) {
              for (var url of buildUrls(split.slice())) {
                urls.push(i + url);
              }
            }            
          } else {
            for (var url of buildUrls(split.slice())) {
              urls.push(cur + url);
            }
          }
          return urls;
        };

        var u = $.urlParam("u");
        if (u != undefined) {
          $("#url").val(unescape(u));
          loadUrls();
        }
      });
    </script>
  </head>
  <body>
    <h1>Image Range Checker</h1>
    <p>Enter url with ranges below and press enter (e.g. http://server[1-2]:808[0-2]/image[1-10].png)</p>
    <input id="url" type="text" />
    <div id="results"></div>
  </body>
</html>
